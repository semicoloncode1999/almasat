"use strict";(self.webpackChunkecommerce=self.webpackChunkecommerce||[]).push([[502],{502:(D,d,r)=>{r.r(d),r.d(d,{CarasouelsModule:()=>J});var p=r(6814),u=r(2129),g=r(3681),c=r(95),t=r(4769),h=r(9881),f=r(2024),m=r(2425),x=r(2788),_=r(553),C=r(9862);let b=(()=>{class o{constructor(e,n){this.http=e,this.toastr=n,this.url=_.N.firebase.databaseURL,this.keyUpdate=""}getCarasouels(){return this.http.get(`${this.url}/carasouels.json`)}getCarasouelsArray(e){let n=[];return this.getCarasouels().subscribe({next:i=>{for(const s in i)i[s].page==e&&n.push(i[s])}}),n}create(e,n){return this.http.put(e?`${this.url}/carasouels/${e}.json`:`${this.url}/error.json`,n)}static#t=this.\u0275fac=function(n){return new(n||o)(t.LFG(C.eN),t.LFG(m._W))};static#e=this.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"})}return o})();function v(o,a){if(1&o&&(t.TgZ(0,"option",18),t._uU(1),t.qZA()),2&o){const e=a.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}function O(o,a){1&o&&(t.TgZ(0,"small",19)(1,"div",20)(2,"span",21),t._uU(3,"Loading..."),t.qZA()(),t._uU(4,"uploading... "),t.qZA())}function M(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",24),t._UZ(1,"img",25),t.TgZ(2,"span",26),t.NdJ("click",function(){const s=t.CHM(e).index,l=t.oxw(3);return t.KtG(l.del(s))}),t._UZ(3,"i",27),t.qZA()()}if(2&o){const e=a.$implicit;t.xp6(1),t.Q6J("src",e,t.LSH)}}function y(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",22),t.NdJ("cdkDropListDropped",function(i){t.CHM(e);const s=t.oxw(2);return t.KtG(s.drop(i))}),t.YNc(1,M,4,1,"div",23),t.qZA()}if(2&o){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.promoImages)}}function P(o,a){if(1&o){const e=t.EpF();t.TgZ(0,"div",5)(1,"form",6),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.submit())}),t.TgZ(2,"div",7)(3,"label",8),t._uU(4,"select page category"),t.qZA(),t.TgZ(5,"select",9),t.NdJ("change",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.getCarasouelCategory(i))}),t._UZ(6,"option",10),t.YNc(7,v,2,2,"option",11),t.qZA()(),t.TgZ(8,"div",7)(9,"label",12),t._uU(10,"upload photo"),t.qZA(),t.TgZ(11,"input",13),t.NdJ("change",function(i){t.CHM(e);const s=t.oxw();return t.KtG(s.uploadImages(i))}),t.qZA()(),t.YNc(12,O,5,0,"small",14),t.YNc(13,y,2,1,"div",15),t.TgZ(14,"div",16)(15,"button",17),t._uU(16,"Edit product"),t.qZA()()()()}if(2&o){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.carasouel),t.xp6(6),t.Q6J("ngForOf",e.categories),t.xp6(5),t.Q6J("ngIf",e.loadingMsg),t.xp6(1),t.Q6J("ngIf",!e.loadingMsg),t.xp6(2),t.Q6J("disabled",!e.promoImages.length||e.loadingMsg)}}function w(o,a){1&o&&t._UZ(0,"img",25),2&o&&t.Q6J("src",a.$implicit.img,t.LSH)}function Z(o,a){if(1&o&&(t.TgZ(0,"div",30)(1,"p")(2,"b"),t._uU(3,"id : "),t.qZA(),t._uU(4),t.qZA(),t.TgZ(5,"p")(6,"b"),t._uU(7,"page : "),t.qZA(),t._uU(8),t.qZA(),t.YNc(9,w,1,1,"img",31),t._UZ(10,"hr"),t.qZA()),2&o){const e=a.$implicit;t.xp6(4),t.hij(" ",e.id,""),t.xp6(4),t.hij(" ",e.page,""),t.xp6(1),t.Q6J("ngForOf",e.images)}}function T(o,a){if(1&o&&(t.TgZ(0,"div",28),t.YNc(1,Z,11,3,"div",29),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.carasouels)}}const I=[{path:"",component:(()=>{class o{get imagesArray(){return this.carasouel.get("images")}constructor(e,n,i,s,l,z){this.formBuilder=e,this.productServ=n,this.uploadServ=i,this.toastr=s,this.firestorage=l,this.carasouelServ=z,this.controlView="data",this.promoImages=[],this.carasouels=[],this.loadingMsg="",this.subscribtions=[],this.carasouel=this.formBuilder.group({id:[(new Date).getTime()],images:this.formBuilder.array([],c.kI.minLength(1)),page:["",c.kI.required]}),this.categories=n.productCategories,this.getCarasouelCategory("")}resetData(){this.carasouel.patchValue({id:(new Date).getTime(),page:""}),this.globalCarasouelObject={},this.imagesArray.clear(),this.promoImages=[],this.uploadServ.imagesArray=[],this.carasouels=[]}uploadImages(e){this.loadingMsg="uploading",this.uploadServ.uploadImg(e.target.files).then(n=>{this.promoImages=n,this.orderingProductImages(),this.loadingMsg=""})}drop(e){(0,g.bA)(this.promoImages,e.previousIndex,e.currentIndex),this.uploadServ.imagesArray=this.promoImages,this.orderingProductImages()}orderingProductImages(){this.imagesArray.clear();for(const e of this.promoImages){let n=this.formBuilder.group({img:e});this.imagesArray.push(n)}}getCarasouelCategory(e){this.resetData(),this.subscribtions.push(this.carasouelServ.getCarasouels().subscribe({next:n=>{for(const i in n)if("edit"==this.controlView){if(n[i].page==e.target.value){this.globalCarasouelObject=n[i],this.globalCarasouelObjectKey=i;break}}else this.carasouels.push(n[i])},complete:()=>{if("edit"==this.controlView){this.carasouel.patchValue({id:this.globalCarasouelObject.id,page:this.globalCarasouelObject.page});for(const n of this.globalCarasouelObject.images)this.promoImages.push(n.img);this.uploadServ.imagesArray=this.promoImages}}}))}submit(){this.carasouel.valid?this.subscribtions.push(this.carasouelServ.create(this.globalCarasouelObjectKey,this.carasouel.value).subscribe(()=>{this.resetData(),this.toastr.success("carasouel uploaded successfully"),this.getCarasouelCategory(""),this.controlView="data"})):this.toastr.error("complete all carasouel data")}del(e){this.firestorage.refFromURL(this.promoImages[e]).delete(),this.promoImages.splice(e,1),this.uploadServ.imagesArray=this.promoImages,this.orderingProductImages()}ngOnDestroy(){for(const e of this.subscribtions)e.unsubscribe()}static#t=this.\u0275fac=function(n){return new(n||o)(t.Y36(c.qu),t.Y36(h.D),t.Y36(f.N),t.Y36(m._W),t.Y36(x.Q1),t.Y36(b))};static#e=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-carasouels"]],decls:7,vars:4,consts:[[1,"container","d-flex","justify-content-end","buttons-group"],[1,"btn","btn-warning",3,"disabled","click"],[1,"btn","btn-secondary",3,"disabled","click"],["class","container",4,"ngIf"],["class","pre-delete",4,"ngIf"],[1,"container"],[3,"formGroup","ngSubmit"],[1,"form-group"],["for","page"],["name","page","id","page",1,"form-select",3,"change"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","file"],["type","file","multiple","",1,"form-control",3,"change"],["class","loading-text",4,"ngIf"],["cdkDropList","","cdkDropListOrientation","horizontal","class","example-list text-center",3,"cdkDropListDropped",4,"ngIf"],[1,"text-center","p-2"],["type","submit",1,"btn","btn-warning",3,"disabled"],[3,"value"],[1,"loading-text"],["role","status",1,"spinner-grow"],[1,"visually-hidden"],["cdkDropList","","cdkDropListOrientation","horizontal",1,"example-list","text-center",3,"cdkDropListDropped"],["class","example-box","cdkDrag","",4,"ngFor","ngForOf"],["cdkDrag","",1,"example-box"],["alt","",1,"image-product",3,"src"],[1,"delete-image","text-danger",3,"click"],[1,"bi","bi-x-circle"],[1,"pre-delete"],["class","m-1",4,"ngFor","ngForOf"],[1,"m-1"],["alt","","class","image-product",3,"src",4,"ngFor","ngForOf"]],template:function(n,i){1&n&&(t.TgZ(0,"div",0)(1,"button",1),t.NdJ("click",function(){return i.controlView="edit",i.resetData()}),t._uU(2,"edit"),t.qZA(),t.TgZ(3,"button",2),t.NdJ("click",function(l){return i.controlView="data",i.getCarasouelCategory(l)}),t._uU(4,"show data"),t.qZA()(),t.YNc(5,P,17,5,"div",3),t.YNc(6,T,2,1,"div",4)),2&n&&(t.xp6(1),t.Q6J("disabled","edit"==i.controlView),t.xp6(2),t.Q6J("disabled","data"==i.controlView),t.xp6(2),t.Q6J("ngIf","edit"==i.controlView),t.xp6(1),t.Q6J("ngIf","data"==i.controlView))},dependencies:[p.sg,p.O5,c._Y,c.YN,c.Kr,c.JL,c.sg,g.Zt,g.Wj],styles:[".image-product[_ngcontent-%COMP%]{width:120px!important;height:115px!important}",".buttons-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin-left:15px;font-size:small}td[_ngcontent-%COMP%]{font-size:small}td[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{margin:5px;font-size:small!important}.image-product[_ngcontent-%COMP%]{width:90px!important;height:92px!important;border-radius:11px;margin:5px;padding:4px}.drop-container[_ngcontent-%COMP%]{display:flex;gap:10px;flex-direction:column;justify-content:center;align-items:center;height:100px;padding:20px;border-radius:10px;border:2px dashed #b5a654;color:#444;cursor:pointer;transition:background .2s ease-in-out,border .2s ease-in-out;width:100%;position:relative;z-index:1}.drop-container[_ngcontent-%COMP%]:hover{background:#eee;border-color:#111}.drop-container[_ngcontent-%COMP%]:hover   .drop-title[_ngcontent-%COMP%]{color:#222}.drop-title[_ngcontent-%COMP%]{color:#444;font-size:20px;font-weight:700;text-align:center;transition:color .2s ease-in-out}.file-upload[_ngcontent-%COMP%]{opacity:0;position:absolute;top:0;left:0;width:100%;height:100%;z-index:2}.loading-text[_ngcontent-%COMP%]{font-size:16px;text-transform:capitalize;display:block;margin-top:12px;margin-bottom:0;text-align:center;color:#daa520;animation-name:_ngcontent-%COMP%_loading;animation-iteration-count:infinite;animation-duration:2.5s;animation-timing-function:ease-out}.spinner-grow[_ngcontent-%COMP%]{--bs-spinner-width: 15px;--bs-spinner-height: 15px;--bs-spinner-animation-speed: 1s;margin-right:5px}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], option[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{cursor:pointer}.form-group[_ngcontent-%COMP%]{position:relative;margin-bottom:15px}.inputs-group[_ngcontent-%COMP%] > input.form-control[_ngcontent-%COMP%], .inputs-group[_ngcontent-%COMP%] > textarea.form-control[_ngcontent-%COMP%]{margin-top:17px}.inputs-group[_ngcontent-%COMP%]:first-of-type > input.form-control[_ngcontent-%COMP%], .inputs-group[_ngcontent-%COMP%]:first-of-type > textarea.form-control[_ngcontent-%COMP%]{margin-top:5px}.delete-image[_ngcontent-%COMP%]{position:absolute;top:-5px;right:5px;z-index:3;cursor:pointer}label[_ngcontent-%COMP%]{font-size:smaller;font-weight:500;text-transform:capitalize}.remove-form-item[_ngcontent-%COMP%]{position:absolute;top:34%;right:-24px;padding:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center}.add-form-item[_ngcontent-%COMP%]{padding:0;height:20px;width:20px;display:inline-flex;justify-content:center;align-items:center;margin-left:20px}@keyframes _ngcontent-%COMP%_loading{0%{opacity:1}25%{opacity:0}50%{opacity:1}750%{opacity:0}}",".example-list[_ngcontent-%COMP%]{width:-moz-fit-content;width:fit-content;max-width:100%;display:flex;flex-direction:row;background:white;border-radius:4px;overflow:hidden;margin:5px;overflow-x:auto}.example-box[_ngcontent-%COMP%]{padding:6px 7px;border-right:solid 1px #ccc;color:#000000de;display:flex;flex-direction:row;align-items:center;justify-content:space-between;box-sizing:border-box;cursor:move;background:white;font-size:14px;flex-grow:1;flex-basis:0;margin:5px;position:relative}.cdk-drag-preview[_ngcontent-%COMP%]{box-sizing:border-box;border-radius:4px;box-shadow:0 5px 5px -3px #0003,0 8px 10px 1px #00000024,0 3px 14px 2px #0000001f}.cdk-drag-placeholder[_ngcontent-%COMP%]{opacity:0}.cdk-drag-animating[_ngcontent-%COMP%]{transition:transform .25s cubic-bezier(0,0,.2,1)}.example-box[_ngcontent-%COMP%]:last-child{border:none}.example-list.cdk-drop-list-dragging[_ngcontent-%COMP%]   .example-box[_ngcontent-%COMP%]:not(.cdk-drag-placeholder){transition:transform .25s cubic-bezier(0,0,.2,1)}"]})}return o})()}];let A=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[u.Bz.forChild(I),u.Bz]})}return o})();var k=r(1639);let J=(()=>{class o{static#t=this.\u0275fac=function(n){return new(n||o)};static#e=this.\u0275mod=t.oAB({type:o});static#o=this.\u0275inj=t.cJS({imports:[p.ez,A,c.u5,c.UX,k.AdminModule]})}return o})()}}]);